========================================================================
Job Information
========================================================================
Job ID: 2598530
Job Name: fastlof_PenDigits_withoutdupl_norm_v01
Node: uc3n008.localdomain
Started at: Sun Dec 14 05:08:14 PM CET 2025
CPUs allocated: 20
Memory allocated: 48G
Partition: cpu
Thread limit: 5
========================================================================

Working directory: /pfs/data6/home/hu/hu_hu/hu_abdeal01/Final-FastLOF

========================================================================
Environment Information
========================================================================
Python 3.9.18

matplotlib                    3.9.4
numpy                         2.0.2
pandas                        2.3.3
scikit-learn                  1.6.1
========================================================================

========================================================================
Starting Experiment: PenDigits_withoutdupl_norm_v01 - FastLOF
========================================================================


================================================================================
FastLOF Experiment - PenDigits_withoutdupl_norm_v01
================================================================================

Loading dataset: data/PenDigits_withoutdupl_norm_v01.arff

--- Dataset preview (first 5 rows) ---
   att1   att2  att3  att4  att5  ...  att14  att15  att16      id  Class
0  48.0  100.0  20.0  80.0   0.0  ...   30.0   73.0    0.0  3891.0   b'1'
1  38.0  100.0   4.0  85.0   0.0  ...   32.0   73.0    0.0  2908.0   b'1'
2  53.0  100.0  25.0  70.0   0.0  ...   32.0   80.0    0.0  1757.0   b'1'
3  12.0  100.0   0.0  71.0  25.0  ...   20.0   90.0    0.0  9046.0   b'1'
4  26.0  100.0   0.0  83.0  23.0  ...   42.0   37.0    0.0  3895.0   b'1'

[5 rows x 18 columns]
--------------------------------------
Dataset shape: (9868, 17)
Number of anomalies: 20 (0.20%)

Testing thresholds: [0, 1.0, 1.01, 1.1, 1.2]

--------------------------------------------------------------------------------
Running with threshold = 0
--------------------------------------------------------------------------------


=== Experiment B: FastLOF Speed & Scalability ===
Using contamination parameter: 0.0020
Testing k values: [10, 20, 30, 40, 50]
Chunk sizes: 3000 to 100 (step=100)

--- Running baseline LOF ---
  k=10 (ball_tree)... 52.2317s (kd_tree)... 0.4784s (brute)... 0.0860s
  k=20 (ball_tree)... 0.8140s (kd_tree)... 0.5931s (brute)... 0.0976s
  k=30 (ball_tree)... 55.6901s (kd_tree)... 12.5882s (brute)... 3.2974s
  k=40 (ball_tree)... 31.3015s (kd_tree)... 16.4527s (brute)... 3.2919s
  k=50 (ball_tree)... 55.7631s (kd_tree)... 14.1465s (brute)... 4.2192s

Baseline algorithms:
  LOF ball_tree (averaged): 39.1601s
  LOF kd_tree (averaged): 8.8518s
  LOF brute (averaged): 2.1984s

Using LOF brute as reference for FastLOF comparisons

Testing chunk sizes: [3000, 2900, 2800, 2700, 2600, 2500, 2400, 2300, 2200, 2100, 2000, 1900, 1800, 1700, 1600, 1500, 1400, 1300, 1200, 1100, 1000, 900, 800, 700, 600, 500, 400, 300, 200, 100]

--- Running FastLOF ---
Chunk size 3000:
  k=10... 413.4053s
  k=20... 0.1155s
  k=30... 0.1217s
  k=40... 0.1328s
  k=50... 0.1412s
  Averaged: 82.7833s, corr=1.0000
Chunk size 2900:
  k=10... 2.7258s
  k=20... 0.5785s
  k=30... 0.0985s
  k=40... 0.1105s
  k=50... 0.1364s
  Averaged: 0.7299s, corr=1.0000
Chunk size 2800:
  k=10... 4.2825s
  k=20... 8.4858s
  k=30... 11.2697s
  k=40... 0.1478s
  k=50... 1.3813s
  Averaged: 5.1134s, corr=1.0000
Chunk size 2700:
  k=10... 6.5789s
  k=20... 5.8404s
  k=30... 7.1061s
  k=40... 5.9895s
  k=50... 7.4985s
  Averaged: 6.6027s, corr=1.0000
Chunk size 2600:
  k=10... 7.2411s
  k=20... 5.9931s
  k=30... 6.9761s
  k=40... 3.5210s
  k=50... 6.0750s
  Averaged: 5.9613s, corr=1.0000
Chunk size 2500:
  k=10... 5.8122s
  k=20... 4.3903s
  k=30... 7.5838s
  k=40... 9.8360s
  k=50... 6.3214s
  Averaged: 6.7887s, corr=1.0000
Chunk size 2400:
  k=10... 7.1592s
  k=20... 9.3443s
  k=30... 8.9882s
  k=40... 8.8063s
  k=50... 7.9620s
  Averaged: 8.4520s, corr=1.0000
Chunk size 2300:
  k=10... 6.8795s
  k=20... 9.4168s
  k=30... 8.1259s
  k=40... 11.0057s
  k=50... 9.4352s
  Averaged: 8.9726s, corr=1.0000
Chunk size 2200:
  k=10... 9.9369s
  k=20... 10.4708s
  k=30... 6.3362s
  k=40... 0.1080s
  k=50... 0.1096s
  Averaged: 5.3923s, corr=1.0000
Chunk size 2100:
  k=10... 3.7619s
  k=20... 1.6708s
  k=30... 0.2666s
  k=40... 0.1011s
  k=50... 0.1063s
  Averaged: 1.1813s, corr=1.0000
Chunk size 2000:
  k=10... 0.5003s
  k=20... 0.0834s
  k=30... 0.0879s
  k=40... 0.0943s
  k=50... 0.0975s
  Averaged: 0.1727s, corr=1.0000
Chunk size 1900:
  k=10... 0.0681s
  k=20... 0.0788s
  k=30... 0.0887s
  k=40... 0.1386s
  k=50... 0.1061s
  Averaged: 0.0960s, corr=1.0000
Chunk size 1800:
  k=10... 0.0690s
  k=20... 0.0803s
  k=30... 0.0917s
  k=40... 0.1001s
  k=50... 0.1021s
  Averaged: 0.0887s, corr=1.0000
Chunk size 1700:
  k=10... 0.0682s
  k=20... 0.0827s
  k=30... 0.0901s
  k=40... 0.0985s
  k=50... 0.1039s
  Averaged: 0.0887s, corr=1.0000
Chunk size 1600:
  k=10... 0.0693s
  k=20... 0.0881s
  k=30... 0.0956s
  k=40... 0.1046s
  k=50... 0.1478s
  Averaged: 0.1011s, corr=1.0000
Chunk size 1500:
  k=10... 0.0701s
  k=20... 0.1191s
  k=30... 0.0941s
  k=40... 0.2953s
  k=50... 13.6082s
  Averaged: 2.8374s, corr=1.0000
Chunk size 1400:
  k=10... 13.1567s
  k=20... 11.8412s
  k=30... 11.6256s
  k=40... 17.2728s
  k=50... 15.4934s
  Averaged: 13.8780s, corr=1.0000
Chunk size 1300:
  k=10... 14.8355s
  k=20... 18.9225s
  k=30... 15.0265s
  k=40... 14.5650s
  k=50... 17.1383s
  Averaged: 16.0976s, corr=1.0000
Chunk size 1200:
  k=10... 12.1587s
  k=20... 11.6495s
  k=30... 15.9122s
  k=40... 14.4576s
  k=50... 15.0714s
  Averaged: 13.8499s, corr=1.0000
Chunk size 1100:
  k=10... 17.4494s
  k=20... 14.7788s
  k=30... 11.7355s
  k=40... 18.4924s
  k=50... 18.5413s
  Averaged: 16.1995s, corr=1.0000
Chunk size 1000:
  k=10... 17.3553s
  k=20... 16.1598s
  k=30... 13.8561s
  k=40... 18.2932s
  k=50... 16.6127s
  Averaged: 16.4554s, corr=1.0000
Chunk size 900:
  k=10... 17.9007s
  k=20... 18.3305s
  k=30... 14.3609s
  k=40...